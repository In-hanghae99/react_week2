{"ast":null,"code":"import { db } from \"../../firebase\";\nimport { collection, doc, getDoc, getDocs, addDoc, updateDoc, deleteDoc } from \"firebase/firestore\"; //Action Type\n\nconst LOAD = \"dictionary/LOAD\";\nconst CREATE = \"dictionary/CREATE\";\nconst DELETE = \"dictionary/DELETE\";\nconst UPDATE = \"dictionary/UPDATE\";\nconst initialState = {\n  list: [{\n    word: \"aaa\",\n    explanation: \"aaa\",\n    example: \"aaa\"\n  }, {\n    word: \"bbb\",\n    explanation: \"bbb\",\n    example: \"bbb\"\n  }, {\n    word: \"ccc\",\n    explanation: \"ccc\",\n    example: \"ccc\"\n  }, {\n    word: \"ddd\",\n    explanation: \"ddd\",\n    example: \"ddd\"\n  }, {\n    word: \"eee\",\n    explanation: \"eee\",\n    example: \"eee\"\n  }, {\n    word: \"fff\",\n    explanation: \"fff\",\n    example: \"fff\"\n  }]\n}; //Action Creator\n\nexport const loadDictionary = dictionary_list => {\n  return {\n    type: LOAD,\n    dictionary_list\n  };\n};\nexport const createDictionary = dictionary => {\n  return {\n    type: CREATE,\n    dictionary\n  };\n};\nexport const deleteDictionary = dictionary_index => {\n  return {\n    type: DELETE,\n    dictionary_index\n  };\n};\nexport function updateDictionary(dictionary_list, dictionary_index) {\n  return {\n    type: UPDATE,\n    dictionary_list,\n    dictionary_index\n  };\n} //middlewares\n\nexport const loadDictionaryFB = () => {\n  return async function (dispatch) {\n    const dictionary_data = await getDocs(collection(db, \"dictionary\"));\n    let dictionary_list = [];\n    dictionary_data.forEach(doc => {\n      dictionary_list.push({\n        id: doc.id,\n        ...doc.data()\n      });\n      console.log(doc.data());\n    });\n    console.log(dictionary_list);\n    dispatch(loadDictionary(dictionary_list));\n  };\n}; //추가\n\nexport const addDictionaryFB = dictionary => {\n  return async function (dispatch) {\n    const docRef = await addDoc(collection(db, \"dictionary\"), dictionary);\n    const dictionary_data = {\n      id: docRef.id,\n      ...dictionary\n    };\n    dispatch(createDictionary(dictionary_data));\n  };\n}; //삭제\n\nexport const deleteDictionaryFB = dictionary_id => {\n  return async function (dispatch) {\n    const docRef = doc(db, \"dictionary\", dictionary_id);\n    await deleteDoc(docRef);\n    dispatch(deleteDictionary(dictionary_id));\n  };\n}; //업데이트\n\nexport const updateDictionaryFB = dictionary_list => {\n  return async function (dispatch, getState) {\n    if (!dictionary_list.id) {\n      window.alert(\"아이디가 없습니다.\");\n      return;\n    }\n\n    const docRef = doc(db, \"dictionary\", dictionary_list.id); // 어떤 걸 수정 할 지 document를 집어온다.\n\n    await updateDoc(docRef, {\n      word: dictionary_list.word,\n      explanation: dictionary_list.explanation,\n      example: dictionary_list.example,\n      memory: dictionary_list.memory\n    }); // firestore의 값을 수정한다.\n    // const dictionary_data = (await getDoc(docRef)).data()\n    // dogRef는 document 타입으로 참조값이기 때문에 await(getDoc(docRef)).data()를 사용해서 dictionary collection에서 수정된 데이터를 불러왔다.\n\n    const _dictionary_list = getState().dictionary; // firestore의 데이터를 다 불러온다.\n\n    const dictionary_index = _dictionary_list.list.findIndex(d => {\n      return d.id === dictionary_list.id;\n    });\n\n    dispatch(updateDictionary(dictionary_list, dictionary_index));\n  };\n}; // Reducer\n\nexport default function reducer() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  switch (action.type) {\n    // do reducer stuff\n    case \"dictionary/LOAD\":\n      return {\n        list: action.dictionary_list\n      };\n\n    case \"dictionary/CREATE\":\n      {\n        const new_dictionary_list = [...state.list, action.dictionary];\n        return {\n          list: new_dictionary_list\n        };\n      }\n\n    default:\n      return state;\n  }\n}","map":{"version":3,"sources":["/Users/bong/sparta/react_week2/dictionary/src/redux/modules/dictionary.js"],"names":["db","collection","doc","getDoc","getDocs","addDoc","updateDoc","deleteDoc","LOAD","CREATE","DELETE","UPDATE","initialState","list","word","explanation","example","loadDictionary","dictionary_list","type","createDictionary","dictionary","deleteDictionary","dictionary_index","updateDictionary","loadDictionaryFB","dispatch","dictionary_data","forEach","push","id","data","console","log","addDictionaryFB","docRef","deleteDictionaryFB","dictionary_id","updateDictionaryFB","getState","window","alert","memory","_dictionary_list","findIndex","d","reducer","state","action","new_dictionary_list"],"mappings":"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","sourcesContent":["import { db } from \"../../firebase\";\nimport {\n  collection,\n  doc,\n  getDoc,\n  getDocs,\n  addDoc,\n  updateDoc,\n  deleteDoc,\n} from \"firebase/firestore\";\n\n//Action Type\nconst LOAD = \"dictionary/LOAD\";\nconst CREATE = \"dictionary/CREATE\";\nconst DELETE = \"dictionary/DELETE\";\nconst UPDATE = \"dictionary/UPDATE\";\n\nconst initialState = {\n  list: [\n    { word: \"aaa\", explanation: \"aaa\", example: \"aaa\" },\n    { word: \"bbb\", explanation: \"bbb\", example: \"bbb\" },\n    { word: \"ccc\", explanation: \"ccc\", example: \"ccc\" },\n    { word: \"ddd\", explanation: \"ddd\", example: \"ddd\" },\n    { word: \"eee\", explanation: \"eee\", example: \"eee\" },\n    { word: \"fff\", explanation: \"fff\", example: \"fff\" },\n  ],\n};\n\n//Action Creator\nexport const loadDictionary = (dictionary_list) => {\n  return { type: LOAD, dictionary_list };\n};\n\nexport const createDictionary = (dictionary) => {\n  return { type: CREATE, dictionary };\n};\n\nexport const deleteDictionary = (dictionary_index) => {\n  return { type: DELETE, dictionary_index };\n};\n\nexport function updateDictionary(dictionary_list, dictionary_index) {\n  return {\n    type: UPDATE,\n    dictionary_list,\n    dictionary_index,\n  };\n}\n\n//middlewares\nexport const loadDictionaryFB = () => {\n  return async function (dispatch) {\n    const dictionary_data = await getDocs(collection(db, \"dictionary\"));\n\n    let dictionary_list = [];\n\n    dictionary_data.forEach((doc) => {\n      dictionary_list.push({ id: doc.id, ...doc.data() });\n      console.log(doc.data());\n    });\n    console.log(dictionary_list);\n    dispatch(loadDictionary(dictionary_list));\n  };\n};\n\n//추가\nexport const addDictionaryFB = (dictionary) => {\n  return async function (dispatch) {\n    const docRef = await addDoc(collection(db, \"dictionary\"), dictionary);\n    const dictionary_data = { id: docRef.id, ...dictionary };\n    dispatch(createDictionary(dictionary_data));\n  };\n};\n\n//삭제\nexport const deleteDictionaryFB = (dictionary_id) => {\n  return async function (dispatch) {\n    const docRef = doc(db, \"dictionary\", dictionary_id);\n    await deleteDoc(docRef);\n    dispatch(deleteDictionary(dictionary_id));\n  };\n};\n\n//업데이트\nexport const updateDictionaryFB = (dictionary_list) => {\n  return async function (dispatch, getState) {\n    if (!dictionary_list.id) {\n      window.alert(\"아이디가 없습니다.\");\n      return;\n    }\n\n    const docRef = doc(db, \"dictionary\", dictionary_list.id);\n    // 어떤 걸 수정 할 지 document를 집어온다.\n\n    await updateDoc(docRef, {\n      word: dictionary_list.word,\n      explanation: dictionary_list.explanation,\n      example: dictionary_list.example,\n      memory: dictionary_list.memory,\n    });\n    // firestore의 값을 수정한다.\n\n    // const dictionary_data = (await getDoc(docRef)).data()\n    // dogRef는 document 타입으로 참조값이기 때문에 await(getDoc(docRef)).data()를 사용해서 dictionary collection에서 수정된 데이터를 불러왔다.\n\n    const _dictionary_list = getState().dictionary;\n    // firestore의 데이터를 다 불러온다.\n\n    const dictionary_index = _dictionary_list.list.findIndex((d) => {\n      return d.id === dictionary_list.id;\n    });\n\n    dispatch(updateDictionary(dictionary_list, dictionary_index));\n  };\n};\n\n// Reducer\nexport default function reducer(state = initialState, action = {}) {\n  switch (action.type) {\n    // do reducer stuff\n    case \"dictionary/LOAD\":\n      return { list: action.dictionary_list };\n    case \"dictionary/CREATE\": {\n      const new_dictionary_list = [...state.list, action.dictionary];\n      return { list: new_dictionary_list };\n    }\n\n    default:\n      return state;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}